<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Architecture Platform - Transform Addresses into Professional Designs</title>
    <meta name="description" content="AI-powered architecture platform that transforms any address into professional architectural files with location intelligence." />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèóÔ∏è</text></svg>" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 3rem;
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 1rem;
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.2rem;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
            padding: 2rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 16px;
        }
        
        .feature {
            text-align: center;
            padding: 1.5rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .feature:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .feature-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .feature-desc {
            color: #7f8c8d;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .demo-section {
            background: white;
            padding: 2.5rem;
            border-radius: 16px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: stretch;
        }
        
        input { 
            flex: 1;
            padding: 1.2rem 1.5rem;
            font-size: 1.1rem;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }
        
        button { 
            padding: 1.2rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 180px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .message {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 12px;
            display: none;
            animation: fadeIn 0.4s ease;
            font-weight: 500;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        #error { 
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            border-left: 4px solid #c44569;
        }
        
        #success {
            background: linear-gradient(135deg, #2ed573 0%, #1e90ff 100%);
            color: white;
            border-left: 4px solid #0984e3;
        }
        
        #loading {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            text-align: center;
            border-left: 4px solid #2d3436;
        }
        
        .spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 12px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .results {
            margin-top: 2.5rem;
            display: none;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .results h3 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            text-align: center;
        }
        
        .file-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .file-link {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, #2ed573 0%, #17a2b8 100%);
            color: white;
            text-decoration: none;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }
        
        .file-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .file-link:hover::before {
            left: 100%;
        }
        
        .file-link:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 35px rgba(46, 213, 115, 0.4);
        }
        
        .file-link.png {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }
        
        .file-link.png:hover {
            box-shadow: 0 15px 35px rgba(255, 107, 107, 0.4);
        }
        
        .file-link.dxf {
            background: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%);
        }
        
        .file-link.dxf:hover {
            box-shadow: 0 15px 35px rgba(253, 203, 110, 0.4);
        }
        
        .file-link.ifc {
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
        }
        
        .file-link.ifc:hover {
            box-shadow: 0 15px 35px rgba(108, 92, 231, 0.4);
        }
        
        .file-icon {
            font-size: 1.8rem;
        }
        
        .api-info {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
            text-align: center;
        }
        
        .api-links {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 1rem;
        }
        
        .api-link {
            padding: 0.8rem 1.5rem;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .api-link:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        .status-online {
            background: #2ed573;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 0.5rem;
                padding: 2rem;
            }
            
            h1 {
                font-size: 2.5rem;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
            
            .file-links {
                grid-template-columns: 1fr;
            }
            
            .api-links {
                flex-direction: column;
                align-items: center;
            }
        }
        
        .footer {
            text-align: center;
            margin-top: 3rem;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .footer a {
            color: #667eea;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèóÔ∏è AI Architecture Platform</h1>
            <p class="subtitle">Transform any address worldwide into professional architectural designs with advanced location intelligence and climate analysis</p>
        </div>
        
        <div class="features-grid">
            <div class="feature">
                <span class="feature-icon">üåç</span>
                <div class="feature-title">Location Intelligence</div>
                <div class="feature-desc">Comprehensive climate analysis and solar optimization for any global location</div>
            </div>
            <div class="feature">
                <span class="feature-icon">üèõÔ∏è</span>
                <div class="feature-title">Architectural Styles</div>
                <div class="feature-desc">Regional architectural recommendations based on local culture and materials</div>
            </div>
            <div class="feature">
                <span class="feature-icon">ü§ñ</span>
                <div class="feature-title">AI Generation</div>
                <div class="feature-desc">Advanced AI creates context-aware floor plans and 3D visualizations</div>
            </div>
            <div class="feature">
                <span class="feature-icon">üìê</span>
                <div class="feature-title">Professional Output</div>
                <div class="feature-desc">Industry-standard CAD (DXF) and BIM (IFC) files ready for development</div>
            </div>
        </div>
        
        <div class="demo-section">
            <h2 style="text-align: center; margin-bottom: 2rem; color: #2c3e50;">Generate Your Architectural Design</h2>
            
            <div class="input-group">
                <input id="address" placeholder="Enter any address worldwide (e.g., DN4 7BH, 123 Main St, London, Tokyo)" />
                <button id="go">Generate Design</button>
            </div>
            
            <div id="loading" class="message">
                <div class="spinner"></div>
                <span>Analyzing location and generating professional architectural files... This may take 15-30 seconds.</span>
            </div>
            
            <div id="error" class="message"></div>
            <div id="success" class="message"></div>
            
            <div id="results" class="results">
                <h3>üìÅ Your Professional Architectural Files</h3>
                <div id="file-links" class="file-links"></div>
            </div>
        </div>
        
        <div class="api-info">
            <h3 style="color: #2c3e50; margin-bottom: 1rem;">
                <span class="status-indicator status-online"></span>
                Platform Status & API Access
            </h3>
            <p style="color: #7f8c8d; margin-bottom: 1rem;">
                Advanced AI architecture platform with location intelligence and professional file generation
            </p>
            <div class="api-links">
                <a href="/api/status" class="api-link" target="_blank">üìä System Status</a>
                <a href="/api/health" class="api-link" target="_blank">üîç Health Check</a>
                <a href="/docs" class="api-link" target="_blank">üìö API Documentation</a>
            </div>
        </div>
        
        <div class="footer">
            <p>
                Powered by advanced AI and location intelligence ‚Ä¢ 
                <a href="https://github.com" target="_blank">Open Source</a> ‚Ä¢ 
                Professional architectural design automation
            </p>
        </div>
    </div>

    <script>
        const addressInput = document.getElementById("address");
        const generateButton = document.getElementById("go");
        const errorDiv = document.getElementById("error");
        const successDiv = document.getElementById("success");
        const loadingDiv = document.getElementById("loading");
        const resultsDiv = document.getElementById("results");
        const fileLinksDiv = document.getElementById("file-links");

        // Enhanced address examples with rotation
        const addressExamples = [
            "DN4 7BH, UK",
            "123 Main Street, New York",
            "1600 Pennsylvania Avenue, Washington DC",
            "Big Ben, London, UK",
            "Times Square, New York",
            "Eiffel Tower, Paris, France",
            "Sydney Opera House, Australia",
            "Burj Khalifa, Dubai",
            "Machu Picchu, Peru",
            "Red Square, Moscow"
        ];

        let exampleIndex = 0;
        
        // Rotate placeholder examples
        function updatePlaceholder() {
            addressInput.placeholder = `Enter address (e.g., ${addressExamples[exampleIndex]})`;
            exampleIndex = (exampleIndex + 1) % addressExamples.length;
        }
        
        // Update placeholder every 3 seconds
        setInterval(updatePlaceholder, 3000);

        async function generateLayout() {
            const address = addressInput.value.trim();
            
            // Reset UI state
            hideAllMessages();
            
            // Enhanced validation
            if (!address) {
                showError("Please enter a valid address or location");
                return;
            }
            
            if (address.length < 3) {
                showError("Address too short - please enter a more specific location");
                return;
            }
            
            if (address.length > 200) {
                showError("Address too long (maximum 200 characters)");
                return;
            }
            
            // Show loading state
            showLoading();
            
            try {
                console.log("üöÄ Generating design for address:", address);
                
                const response = await fetch(`/design/plan?address=${encodeURIComponent(address)}&building_type=clinic&area_sqm=200&style_preference=local`);
                console.log("üì° Response status:", response.status);
                
                if (response.status === 429) {
                    showError("Rate limit exceeded. Please wait a moment before generating another design.");
                    return;
                }
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || `Server error (${response.status})`);
                }
                
                const data = await response.json();
                console.log("‚úÖ Response data:", data);
                
                if (data.success) {
                    showSuccess(address, data);
                    showResults(data);
                } else {
                    throw new Error("Design generation failed");
                }
                
            } catch (error) {
                console.error("‚ùå Error:", error);
                showError(error.message || "An unexpected error occurred. Please try again.");
            } finally {
                hideLoading();
            }
        }

        function hideAllMessages() {
            errorDiv.style.display = "none";
            successDiv.style.display = "none";
            resultsDiv.style.display = "none";
        }

        function showLoading() {
            loadingDiv.style.display = "block";
            generateButton.disabled = true;
            generateButton.textContent = "Generating...";
        }

        function hideLoading() {
            loadingDiv.style.display = "none";
            generateButton.disabled = false;
            generateButton.textContent = "Generate Design";
        }

        function showError(message) {
            errorDiv.innerHTML = `
                <strong>‚ùå Generation Failed</strong><br>
                ${message}
                <br><small>Please verify the address and try again. If the problem persists, the address might not be recognized by our geocoding service.</small>
            `;
            errorDiv.style.display = "block";
        }

        function showSuccess(address, data) {
            const enhancedFeatures = data.system_info?.enhanced_features ? "with advanced location intelligence" : "using basic geocoding";
            
            successDiv.innerHTML = `
                <strong>üéâ Design Generated Successfully!</strong><br>
                Professional architectural files created for: <em>${address}</em><br>
                <small>Generated ${enhancedFeatures} ‚Ä¢ All files ready for download ‚Ä¢ Industry-standard formats</small>
            `;
            successDiv.style.display = "block";
        }

        function showResults(data) {
            const files = data.design_files;
            const projectInfo = data.project_info || {};
            
            fileLinksDiv.innerHTML = `
                <a href="${files.plan_png}" class="file-link png" target="_blank" onclick="trackDownload('png')">
                    <span class="file-icon">üñºÔ∏è</span>
                    <div>
                        <div>Floor Plan (PNG)</div>
                        <small>High-resolution architectural layout</small>
                    </div>
                </a>
                <a href="${files.dxf}" class="file-link dxf" target="_blank" download onclick="trackDownload('dxf')">
                    <span class="file-icon">üìê</span>
                    <div>
                        <div>CAD File (DXF)</div>
                        <small>AutoCAD compatible drawing</small>
                    </div>
                </a>
                <a href="${files.ifc}" class="file-link ifc" target="_blank" download onclick="trackDownload('ifc')">
                    <span class="file-icon">üèóÔ∏è</span>
                    <div>
                        <div>BIM Model (IFC)</div>
                        <small>Industry standard building model</small>
                    </div>
                </a>
            `;
            resultsDiv.style.display = "block";
        }

        function trackDownload(fileType) {
            console.log(`üì• User downloaded ${fileType.toUpperCase()} file`);
            
            // Add visual feedback
            const link = event.currentTarget;
            const originalText = link.innerHTML;
            link.style.transform = 'scale(0.95)';
            
            setTimeout(() => {
                link.style.transform = 'scale(1)';
            }, 150);
        }

        // Event listeners
        generateButton.addEventListener("click", generateLayout);
        
        addressInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
                generateLayout();
            }
        });

        // Auto-focus input on page load
        window.addEventListener("load", () => {
            addressInput.focus();
            updatePlaceholder();
        });

        // Check API status on load
        async function checkApiStatus() {
            try {
                const response = await fetch('/api/status');
                if (response.ok) {
                    console.log("‚úÖ API is online and ready");
                }
            } catch (error) {
                console.warn("‚ö†Ô∏è Could not verify API status");
            }
        }

        checkApiStatus();
    </script>
</body>
</html>
